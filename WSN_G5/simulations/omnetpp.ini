# COSC 6357 â€“ WSN Group Project
# OMNeT++ 6.x configuration file

# --- General Settings ---
sim-time-limit = 1800s
repeat = 3
warmup-period = 60s
rng-class = "cMersenneTwister"

[Config Group5]
description = "Clustered(2 clusters,18); LEACH vs PEGASIS"
seed-set = 22360
network = WsnNetwork

# --- Topology & Nodes ---
**.numNodes = 18
**.topologyType = "clustered"
**.radio.txRange = "35m"

# --- VISUALIZATION FIX ---
**.mobility.initFromDisplayString = false

# --- Clustering Coordinates ---
**.node[0..8].mobility.initialX = uniform(70m, 130m)
**.node[0..8].mobility.initialY = uniform(70m, 130m)
**.node[9..17].mobility.initialX = uniform(270m, 330m)
**.node[9..17].mobility.initialY = uniform(70m, 130m)
**.baseStation.mobility.initialX = 200m
**.baseStation.mobility.initialY = 300m

# --- Protocol Selection ---
*.activeProtocol = ${"Leach", "Pegasis"}

# --- LEACH Settings ---
**.routing.percentage = 0.2

# --- Radio Safety Fix ---
**.radioMedium.maxTransmissionDuration = 100s

# --- Traffic Model ---
**.app.traffic = "constant"
**.app.packetInterval = 0.9s
**.app.payloadBytes = 64B

# --- Energy Model Parameters ---
**.node[*].initialJoules = ${14..26 step 4}J
**.node[*].radioTx_mA = 17.4
**.node[*].radioRx_mA = 19.7
**.node[*].sleep_mA = 0.06
**.node[*].supplyVoltage = 3.0V

# --- MODULE LINKING ---
**.wlan.interfaceTableModule = "^.interfaceTable"
**.wlan.radio.antenna.mobilityModule = "^.^.^.mobility"
**.wlan.radio.energyConsumer.energySourceModule = "^.^.^.energyStorage"

# --- Radio Defaults ---
**.wlan.radio.typename = "Ieee802154NarrowbandScalarRadio"
**.wlan.radio.antenna.typename = "IsotropicAntenna"
**.wlan.radio.transmitter.power = 100mW
**.wlan.radio.receiver.sensitivity = -85dBm

# ============================================================
# ENERGY CONSUMPTION CONFIGURATION (FIXED)
# ============================================================

# 1. BASE STATION: Set to ZERO consumption (Infinite Power)
# We target the baseStation specifically to override the defaults
**.baseStation.wlan.radio.energyConsumer.typename = "StateBasedEpEnergyConsumer"
**.baseStation.wlan.radio.energyConsumer.offPowerConsumption = 0mW
**.baseStation.wlan.radio.energyConsumer.sleepPowerConsumption = 0mW
**.baseStation.wlan.radio.energyConsumer.receiverIdlePowerConsumption = 0mW
**.baseStation.wlan.radio.energyConsumer.receiverBusyPowerConsumption = 0mW
**.baseStation.wlan.radio.energyConsumer.receiverReceivingPowerConsumption = 0mW
**.baseStation.wlan.radio.energyConsumer.transmitterTransmittingPowerConsumption = 0mW

# 2. SENSOR NODES: Realistic consumption with "Standby" Idle
# Power (mW) = Voltage (3V) * Current (mA)
# Sleep/Standby: 0.06mA -> 0.18mW
# Rx: 19.7mA -> 59.1mW
# Tx: 17.4mA -> 52.2mW

**.node[*].wlan.radio.energyConsumer.typename = "StateBasedEpEnergyConsumer"
**.node[*].wlan.radio.energyConsumer.offPowerConsumption = 0mW
**.node[*].wlan.radio.energyConsumer.sleepPowerConsumption = 0.18mW

# CRITICAL FIX: Set Idle to match Sleep (0.18mW). 
# This assumes the radio enters a low-power listening mode when not receiving data.
# If we leave this at 59.1mW, the nodes physically cannot survive 1800s.
**.node[*].wlan.radio.energyConsumer.receiverIdlePowerConsumption = 0.18mW 

# These consume full power:
**.node[*].wlan.radio.energyConsumer.receiverBusyPowerConsumption = 59.1mW
**.node[*].wlan.radio.energyConsumer.receiverReceivingPowerConsumption = 59.1mW
**.node[*].wlan.radio.energyConsumer.transmitterTransmittingPowerConsumption = 52.2mW

# --- Output ---
output-scalar-file = "results/group5-${configname}-${runnumber}.sca"
output-vector-file = "results/group5-${configname}-${runnumber}.vec"

# --- Plots ---
**.scalar-recording = true
**.vector-recording = true
**.stat.pdr = true
**.stat.delay = true
**.stat.residualEnergy = true

# --- Anti-copy markers ---
**.groupId = 5
**.groupKey = "22360-5"